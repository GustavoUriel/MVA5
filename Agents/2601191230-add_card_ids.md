# 2601191230 - Add card ids and names to dynamic cards

Date: 2026-01-19 12:30

Summary
-------
Added `id` and `name` attributes to all dynamically generated card containers in `app/static/js/dataset_analysis.js` so that every card has a unique id and its `name` equals that id. Also ensured inputs created dynamically have `name` attributes matching their ids.

Files changed
-------------
- `app/static/js/dataset_analysis.js`:
  - Column group card: added `id="group_card_${groupKey}"` and `name="group_card_${groupKey}"`.
  - Discarding policy card: added `id="policy_card_${policy.key}"` and `name="policy_card_${policy.key}"`.
  - Discarding policy body: ensured `name` matches `id` (already present).
  - Microbial discarding policy card: added `id="microbial_policy_card_${policy.key}"` and `name="microbial_policy_card_${policy.key}"`.
  - Microbial discarding policy body: ensured `name` matches `id` (already present).
  - Microbial grouping card: added `id="microbial_grouping_card_${method.key}"` and `name="microbial_grouping_card_${method.key}"`.
  - Microbial grouping card body: ensured `name` matches `id` (already present).
  - Stratification card: added `id="strat_card_${key}"` and `name="strat_card_${key}"`.
  - Sample timepoint card (created via `createElement`): set `id` and `name` to `sample_tp_card_${tp.key}`.
  - Analysis method comparison card (created via `createElement`): set `id` and `name` to `analysis_method_card_${m.key}`.
  - Various inputs: ensured `name` attributes match their `id` (policy params, sample tp checkboxes, analysis method checkboxes, etc.).

Why
---
This enforces predictable, unique identifiers for every interactive element (cards and inputs) in the analysis configuration UI, making it easier to reference them from code and avoiding collisions when multiple cards expose similarly-named parameters.

Verification performed
---------------------
- Scanned `dataset_analysis.js` to identify all dynamically-generated input and card templates.
- Updated templates and `createElement` blocks to include `id` and matching `name` attributes.
- Verified collector functions (`collectDiscardingPolicies`, `collectMicrobialDiscardingPolicies`, `collectMicrobialGrouping`) still collect inputs via `input.name` and will now receive unique keys (e.g., `${policyKey}_param_${paramKey}`).
- Verified functions that use `document.getElementById(...)` are unaffected because ids were preserved; added ids only where missing.

Notes
-----
- Radio groups (e.g., microbial grouping methods) intentionally keep a shared `name` (i.e., `microbialGroupingMethod`) to preserve mutual exclusion behavior.
- If you want parameter objects saved without the `${policyKey}_` prefix, I can update the collectors to strip prefixes and group parameters by parent policy key when building the saved configuration.

End of log.
