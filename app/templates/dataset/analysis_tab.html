{% extends "dataset/base.html" %} {% block tab_content %}
<!-- Analysis List Section -->
<div class="row mb-4">
  <div class="col-12">
    <div class="d-flex align-items-center justify-content-between mb-3">
      <div>
        <h5 class="mb-1">
          <i class="fas fa-chart-line me-2 text-primary"></i>
          Analysis Management
        </h5>
        <p class="text-muted mb-0">Create, manage, and run microbiome analyses</p>
      </div>
      <button type="button" class="btn btn-primary" onclick="createNewAnalysis()">
        <i class="fas fa-plus me-1"></i>New Analysis
      </button>
    </div>

    <!-- Analysis List -->
    <div class="card">
      <div class="card-header">
        <div class="d-flex align-items-center justify-content-between">
          <h6 class="mb-0">
            <i class="fas fa-list me-2"></i>
            Existing Analyses
          </h6>
          <div class="btn-group btn-group-sm">
            <button type="button" class="btn btn-outline-secondary" onclick="refreshAnalysisList()">
              <i class="fas fa-sync-alt me-1"></i>Refresh
            </button>
          </div>
        </div>
      </div>
      <div class="card-body">
        <div id="analysisListContainer">
          <!-- Analysis list will be populated here -->
          <div class="text-center py-4" id="noAnalysesState">
            <i class="fas fa-chart-line fa-3x text-muted mb-3"></i>
            <h6 class="text-muted mb-2">No Analyses Created Yet</h6>
            <p class="text-muted mb-3">Create your first analysis to get started with microbiome data exploration.</p>
            <button type="button" class="btn btn-primary" onclick="createNewAnalysis()">
              <i class="fas fa-plus me-1"></i>Create First Analysis
            </button>
          </div>

          <!-- Analysis Table (hidden by default) -->
          <div id="analysisTable" style="display: none">
            <div class="table-responsive">
              <table class="table table-hover">
                <thead>
                  <tr>
                    <th>Name</th>
                    <th>Created</th>
                    <th>Modified</th>
                    <th>Size</th>
                    <th>Last Run</th>
                    <th>Patients</th>
                    <th>Status</th>
                    <th>Actions</th>
                  </tr>
                </thead>
                <tbody id="analysisTableBody">
                  <!-- Analysis rows will be populated here -->
                </tbody>
              </table>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

{% include 'dataset/analysis_config.html' %}

<script>
  // Set dataset ID for JavaScript
  window.datasetId = {{ dataset.id }};
</script>

<script src="{{ url_for('static', filename='js/dataset_utils.js') }}"></script>
<script src="{{ url_for('static', filename='js/dataset_analysis.js') }}"></script>

{% endblock %}
